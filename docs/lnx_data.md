# Linuxでデータ整形・文字列操作
- [データ整形](#データ整形)
    - awk
    - sort
    - uniq
    - grep
    - comm
- [文字列操作](#文字列操作)
## データ整形
### awk
このコマンドだけでいろいろとできる。ここではワンライナー（1行で記述したコード）の場合を例示する。もっと複雑なこともできるが、各自調べること。
#### 例
```
awk '(if $1==0){print $1 "," $2}' INPUT.txt > OUTPUT.txt #1列目が0だった場合、1列目と2列目をカンマ区切りで出力する。
awk '{print $4 "," $2}' INPUT.txt > OUTPUT.txt
cat INPUT.txt | awk -F "," '{a += $1} END {print a}' > OUTPUT.txt
cat INPUT.txt | awk '(if $1 < 100 ){a += $1; print $2} END {print "SUM=" a}' > OUTPUT.txt
```
### sort
ファイルを行ごとに並べ替えるコマンド。複数列からなるファイルの場合は、ある列を基準に並び替えたりもできる。
#### オプション
`-k`：並べ替えの対象行と並べ替えの方法を指定できる。複数指定した場合、1つ目で指定した列が同じものは2つ目で指定した列でソートされる。nやrを指定する場合は、最後のk以外で指定する数値を固定したほうが良い（例：`sort -k 2,2nr -k 1n INPUT`）。また、.（ピリオド）で何文字目を基準にソートするかを指定できる（例：一列目の3文字目でソート`sort -k 1.3 INPUT`）<br>
`-t`：列を区切る文字を指定できる。デフォルトは空白文字。タブ区切りの場合は`-t $'\t'`と指定する。<br>
`-n`：数字を数値として並び替える。類似のものに`-h` `-V`がある。<br>
`-r`：降順で並べ替える。<br>
`-u`：重複した行は1行目のみ表示する。
#### 例
```
$ sort -k 2n INPUT #2列目を数値としてソートする
$ sort -k 3nr -t "," INPUT #タブを区切り文字とし、3列目を数値として降順でソートする。
$ sort -k 3,3 -k 4n -t $'\t' INPUT #3列目でソートした後、4列目を数値としてソートする
```
### uniq
sort済みのファイルから重複した行を取り除く（1つだけにする）。1つ後の行としか比較しないので、sortが必須。`sort -u`で十分なことも多い。
#### 例
```
uniq INPUT.txt #重複を取り除く
```
### grep
文字列を検索する。gzipで圧縮されたファイルの場合、`zgrep`を使う。オプションは`grep`とほぼ同じ。
タブ文字は$'\t'を利用すると検索可能。
#### 例
```
grep GO:1234511 INPUT.txt #INPUT.txt内のGO:1234511が含まれる行を出力する。
grep -C 3 GO:1234511 INPUT.txt #INPUT.txt内のGO:1234511が含まれる行と前後3行を出力する。
grep -C 3 GO:1234511 INPUT.txt #INPUT.txt内のGO:1234511が含まれる行と前後3行を出力する。
```
### comm
sort済みの2つのファイルを行ごとに比較する。1ファイル目にのみ含まれる行を1列目、2ファイル目のみに含まれる行を2列目、共通して含まれる行を3列目に出力する。
#### オプション
`-1`：1ファイル目のみに含まれる行を出力しない。
`-2`：2ファイル目のみに含まれる行を出力しない。
`-3`：共通行を出力しない。
`--output-delimiter`：2列以上出力される場合の区切り文字を=の後に指定する。空白が必要なら"で囲う。
#### 例
```
comm -12 INPUT1.txt INPUT2.txt #共通行のみ取り出す
comm -13 INPUT1.txt INPUT2.txt #2に固有の行のみ取り出す
comm --output-delimiter="," -3 INPUT1.txt INPUT2.txt #共通しない行のみ取り出す。カンマ区切りの2列出力されることに注意。
```
### 組み合わせた例
パイプ`|`を使うとパイプの左側のコマンドの出力を右側のコマンドの入力に使うことができる。<br>
以下のように、タブ区切りで遺伝子名、GOターム、発現量の情報がこの順で含まれている2つのファイルがあるとする。
```
$ cat File1
AT1G308911  GO:12345678 24
AT1G301231  GO:13455654 54
AT1G312531  GO:00183941 8221
~~~略~~~

$ cat File2
AT1G308911  GO:12345678 73
AT1G301231  GO:13455654 1023
AT1G312531  GO:00183941 3816
~~~略~~~

```
**例：2番目のファイルのみに含まれる遺伝子の一覧を取得**
```
$ comm -13 <(awk '{print $1}' File1 | sort -u) <(awk '{print $1}' File2 | sort -u) > OUT.txt
```
File2にのみ含まれる遺伝子名が重複を除いた状態でOUT.txtに出力される。<br>
**例：発現量が100より大きいの遺伝子のうち、両方のファイルに含まれる遺伝子の一覧を取得**
```
$ comm -12 <(awk '(if $3>100){print $1}' File1 | sort -u) <(awk '(if $3>100){print $1}' File2 | sort -u) > OUT.txt
```
発現量が100より大きい遺伝子で、File1とFile2に共通な遺伝子名が重複を除いた状態でOUT.txtに出力される。<br>
**例：File1のうち、GOタームのリスト（GO_list.txt）に含まれるGOをもつ遺伝子の一覧を取得**
```
$ cat GO_list.txt
GO:00000001
GO:00001231
GO:00002334
~~~略~~~

$ grep -f GO_list.txt File1 | awk '{print $1}' | sort -u > OUT.txt
```
File1の遺伝子のうちGO_list.txtに含まれるGOが付与された遺伝子名が重複を除いた状態でOUT.txtに出力される。<br>

## 文字列操作
### perl
### grep
### sed
#### 最短一致
#### タブ文字の検索
#### 正規表現
